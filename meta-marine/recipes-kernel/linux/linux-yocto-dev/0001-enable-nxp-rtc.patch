From e248d43bf7dc8e60b911e3c03e9956ea83b3ca18 Mon Sep 17 00:00:00 2001
From: Trinh Viet Quang <vietquang0708@gmail.com>
Date: Wed, 3 Sep 2025 19:14:50 +0700
Subject: [PATCH] enable nxp rtc

Upstream-Status: Inappropriate [oe specific]

Signed-off-by: Trinh Viet Quang <vietquang0708@gmail.com>
---
 .../boot/dts/rockchip/rk3588-nanopc-t6.dtsi   | 20 +++++++++++++++++--
 1 file changed, 18 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/rockchip/rk3588-nanopc-t6.dtsi b/arch/arm64/boot/dts/rockchip/rk3588-nanopc-t6.dtsi
index 5742da90ce80..161561c1e588 100644
--- a/arch/arm64/boot/dts/rockchip/rk3588-nanopc-t6.dtsi
+++ b/arch/arm64/boot/dts/rockchip/rk3588-nanopc-t6.dtsi
@@ -497,9 +497,22 @@ regulator-state-mem {
 
 &i2c6 {
 	status = "okay";
+
+	pcf8563: rtc@51 {
+		status = "okay";
+		compatible = "nxp,pcf8563";
+		reg = <0x51>;
+		#clock-cells = <0>;
+		clock-output-names = "hym8563";
+		interrupt-parent = <&gpio0>;
+		interrupts = <RK_PB0 IRQ_TYPE_LEVEL_LOW>;
+		pinctrl-names = "default";
+		pinctrl-0 = <&hym8563_int>;
+		wakeup-source;
+	};
 
 	hym8563: rtc@51 {
-		status = "okay";
+		status = "disabled";
 		compatible = "haoyu,hym8563";
 		reg = <0x51>;
 		#clock-cells = <0>;
@@ -708,7 +721,7 @@ pcie@0,0 {
 		wifi: wifi@0,0 {
 			compatible = "pci14e4,449d";
 			reg = <0x210000 0 0 0 0>;
-			clocks = <&hym8563>;
+			clocks = <&pcf8563>;
 			clock-names = "lpo";
 		};
 	};
@@ -1233,6 +1246,7 @@ &u2phy3 {
 &usbdp_phy0 {
 	mode-switch;
 	orientation-switch;
+	svid = <0xff01>;
 	sbu1-dc-gpios = <&gpio4 RK_PA6 GPIO_ACTIVE_HIGH>;
 	sbu2-dc-gpios = <&gpio4 RK_PA7 GPIO_ACTIVE_HIGH>;
 	status = "okay";
@@ -1268,6 +1282,8 @@ &usb_host0_ohci {
 
 &usb_host0_xhci {
 	usb-role-switch;
+	dr_mode = "otg";
+	role-switch-default-mode = "host";
 	status = "okay";
 	port {
 		usb_host0_xhci_drd_sw: endpoint {
-- 
2.43.0

